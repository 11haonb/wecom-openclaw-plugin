---
title: '快速入门'
description: '5 分钟内完成 WeCom OpenClaw 集成配置'
---

## 前置条件

<Check>一台有公网 IP 的服务器（或使用内网穿透）</Check>
<Check>企业微信管理员权限</Check>
<Check>Node.js 18+ 已安装</Check>

---

## 第一步：获取企业微信凭证

### 1.1 获取企业 ID

<Steps>
  <Step title="登录管理后台">
    访问 [企业微信管理后台](https://work.weixin.qq.com/) 并登录
  </Step>
  <Step title="找到企业 ID">
    点击 **我的企业** → 找到 **企业ID**
  </Step>
  <Step title="复制保存">
    复制企业 ID（格式如：`ww1234567890abcdef`）
  </Step>
</Steps>

### 1.2 创建应用

<Steps>
  <Step title="进入应用管理">
    点击 **应用管理** → **自建** → **创建应用**
  </Step>
  <Step title="填写应用信息">
    - 应用名称：如 "AI助手"
    - 应用 Logo：上传一个图标
    - 可见范围：选择需要使用的部门或成员
  </Step>
  <Step title="记录凭证">
    创建后记录以下信息：
    - **AgentId**（应用ID）
    - **Secret**（点击查看获取）
  </Step>
</Steps>

### 1.3 配置消息接收

<Warning>
  **重要**：先不要点确定！需要先启动服务器才能验证通过。
</Warning>

<Steps>
  <Step title="进入 API 设置">
    在应用详情页，找到 **接收消息** → **设置API接收**
  </Step>
  <Step title="生成密钥">
    点击 **随机获取** 生成 Token 和 EncodingAESKey
  </Step>
  <Step title="记录信息">
    记录 Token 和 EncodingAESKey，稍后配置服务器时需要
  </Step>
</Steps>

### 凭证汇总

完成以上步骤后，你应该有以下信息：

| 字段 | 示例值 | 说明 |
|------|--------|------|
| 企业ID | `ww1234567890abcdef` | 企业唯一标识 |
| AgentId | `1000001` | 应用 ID |
| Secret | `xxxxxxxx...` | 应用密钥（32位） |
| Token | `xxxxxxxxxxxxxx` | 回调验证 Token |
| EncodingAESKey | `xxxxxxxxx...` | 消息加密密钥（43位） |

---

## 第二步：配置服务器

### 2.1 安装 OpenClaw

<CodeGroup>

```bash npm
npm install -g openclaw
```

```bash pnpm
pnpm add -g openclaw
```

```bash 从源码安装
git clone https://github.com/openclaw/openclaw.git
cd openclaw
pnpm install
pnpm build
```

</CodeGroup>

### 2.2 创建配置文件

创建配置文件 `~/.openclaw/openclaw.json`：

```json
{
  "env": {
    "OPENROUTER_API_KEY": "你的OpenRouter密钥",
    "WECOM_CORP_ID": "你的企业ID",
    "WECOM_CORP_SECRET": "你的应用Secret",
    "WECOM_AGENT_ID": "你的AgentId",
    "WECOM_CALLBACK_TOKEN": "你的Token",
    "WECOM_CALLBACK_AES_KEY": "你的EncodingAESKey"
  },
  "agents": {
    "defaults": {
      "model": {
        "primary": "openrouter/qwen/qwen3-max"
      }
    }
  },
  "gateway": {
    "mode": "local",
    "bind": "lan"
  },
  "plugins": {
    "entries": {
      "wecom": {
        "enabled": true
      }
    }
  }
}
```

<Tip>
  **获取 OpenRouter API Key**：访问 [openrouter.ai](https://openrouter.ai/) 注册并获取 API Key。
  OpenRouter 支持多种模型，包括 GPT-4、Claude、Qwen 等。
</Tip>

### 2.3 启动服务

<CodeGroup>

```bash 全局安装
openclaw gateway run --bind lan --port 18789
```

```bash 从源码
node dist/entry.js gateway run --bind lan --port 18789
```

```bash 使用代理
HTTPS_PROXY=http://127.0.0.1:7890 openclaw gateway run --bind lan --port 18789
```

</CodeGroup>

看到以下日志说明启动成功：

```
[WeCom] Plugin registered
[WeCom] Corp ID: ww1234567890abcdef
[WeCom] Agent ID: 1000001
[WeCom] Callback path: /wecom/callback
```

---

## 第三步：完成企业微信配置

### 3.1 设置回调 URL

回到企业微信管理后台的 **接收消息** 设置页面：

<Steps>
  <Step title="填写 URL">
    ```
    http://你的服务器IP:18789/wecom/callback
    ```
  </Step>
  <Step title="点击保存">
    如果显示 **验证成功**，恭喜你配置完成！
  </Step>
</Steps>

### 3.2 常见错误

<AccordionGroup>
  <Accordion title="回调地址请求不通">
    **原因**：服务器防火墙阻止了请求

    **解决方案**：
    ```bash
    # 开放 18789 端口
    sudo ufw allow 18789
    # 或使用 iptables
    sudo iptables -A INPUT -p tcp --dport 18789 -j ACCEPT
    ```
  </Accordion>
  <Accordion title="签名校验失败">
    **原因**：Token 或 EncodingAESKey 配置错误

    **解决方案**：
    1. 检查配置文件中的 Token 是否与企业微信后台一致
    2. 确保没有多余的空格或换行
  </Accordion>
  <Accordion title="解密失败">
    **原因**：EncodingAESKey 长度不正确

    **解决方案**：
    EncodingAESKey 必须是 **43 位**，请重新从企业微信后台复制
  </Accordion>
</AccordionGroup>

---

## 第四步：测试

<Steps>
  <Step title="打开企业微信">
    在手机上打开企业微信 APP
  </Step>
  <Step title="找到应用">
    在工作台中找到你创建的 AI 助手应用
  </Step>
  <Step title="发送消息">
    发送一条消息，如："你好"
  </Step>
  <Step title="等待回复">
    等待 AI 回复，通常在几秒内
  </Step>
</Steps>

<Frame>
  <img src="/images/test-chat.png" alt="测试对话" />
</Frame>

---

## 下一步

<CardGroup cols={2}>
  <Card
    title="远程控制电脑"
    icon="desktop"
    href="/features/remote-control"
  >
    通过企业微信远程控制 Windows/Mac 电脑
  </Card>
  <Card
    title="浏览器控制"
    icon="browser"
    href="/features/browser-control"
  >
    远程操控 Chrome 浏览器
  </Card>
  <Card
    title="群聊支持"
    icon="users"
    href="/features/group-chat"
  >
    在群聊中使用 AI 助手
  </Card>
  <Card
    title="安全配置"
    icon="shield"
    href="/configuration/security"
  >
    了解安全最佳实践
  </Card>
</CardGroup>

---

## 获取帮助

如果遇到问题：

1. 查看日志：`tail -f /tmp/gateway.log`
2. 提交 Issue：[GitHub Issues](https://github.com/11haonb/wecom-openclaw-plugin/issues)
3. 联系作者：[liujinqi@bit.edu.cn](mailto:liujinqi@bit.edu.cn)
